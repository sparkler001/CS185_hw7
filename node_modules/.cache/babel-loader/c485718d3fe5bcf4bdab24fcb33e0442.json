{"ast":null,"code":"import _defineProperty from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/yanghaochen/Desktop/CS185/CS185_hw7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import config from'../config.js';// import './Movie.css';\nvar axios=require('axios');var firebase=require('firebase');export var Add_movie=/*#__PURE__*/function(_Component){_inherits(Add_movie,_Component);var _super=_createSuper(Add_movie);function Add_movie(props){var _this;_classCallCheck(this,Add_movie);_this=_super.call(this);_this.myFormHandler=function(event){event.preventDefault();var req='https://www.omdbapi.com/?apikey=2259a45a&i='+_this.state.movId;_this.getMovieName(_assertThisInitialized(_this),req);};_this.inputHandler=function(event){var field=event.target.name;var value=event.target.value;_this.setState(_defineProperty({},field,value));};_this.state={movId:'',src:'',title:'',director:'',imdb:'',plot:''};return _this;}_createClass(Add_movie,[{key:\"componentDidMount\",value:function componentDidMount(){if(!firebase.apps.length){firebase.initializeApp(config);}}},{key:\"updateDb\",value:function updateDb(obj){var formObj={name:obj.state.title,src:obj.state.src,director:obj.state.director,imdb:obj.state.imdb,plot:obj.state.plot};var ref=firebase.database().ref('movies');ref.once('value').then(function(snapshot){var movExists=snapshot.child(obj.state.movId).exists();if(movExists){alert('Already existed');}else{ref.child(obj.state.movId).set(formObj);alert('Movie has been add');}});}},{key:\"getMovieName\",value:function getMovieName(obj,req){axios.get(req).then(function(response){obj.setState({src:response.data.Poster,title:response.data.Title,director:response.data.Director,imdb:response.data.imdbRating,plot:response.data.Plot});}).then(function(){obj.updateDb(obj);}).catch(function(error){console.log(error);});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.myFormHandler},/*#__PURE__*/React.createElement(\"h1\",null,\"Add a New Movie\"),/*#__PURE__*/React.createElement(\"h3\",null,\"Movie ID\"),/*#__PURE__*/React.createElement(\"input\",{name:\"movId\",type:\"text\",required:true,onChange:this.inputHandler}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"color_grey\"},/*#__PURE__*/React.createElement(\"h5\",null,\"* Please give the imdbID of the movie\"),\" \"),/*#__PURE__*/React.createElement(\"div\",{className:\"submit\"},/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",name:\"submit\",value:\"SUBMIT\",style:{width:\"300px\"}}))));}}]);return Add_movie;}(Component);export default Add_movie;","map":{"version":3,"sources":["/Users/yanghaochen/Desktop/CS185/CS185_hw7/src/Components/Add_movie.js"],"names":["React","Component","config","axios","require","firebase","Add_movie","props","myFormHandler","event","preventDefault","req","state","movId","getMovieName","inputHandler","field","target","name","value","setState","src","title","director","imdb","plot","apps","length","initializeApp","obj","formObj","ref","database","once","then","snapshot","movExists","child","exists","alert","set","get","response","data","Poster","Title","Director","imdbRating","Plot","updateDb","catch","error","console","log","width"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport config from '../config.js';\n// import './Movie.css';\n\n\nconst axios = require('axios');\nconst firebase = require('firebase')\n\n\nexport class Add_movie extends Component {\n  constructor(props) {\n    super();\n    this.state = { movId: '', src: '', title: '', director: '', imdb: '',plot: '',}\n  }\n\n  componentDidMount(){\n    if (!firebase.apps.length) {\n      firebase.initializeApp(config);\n    }\n  }\n\n  myFormHandler = (event) => {\n    event.preventDefault();\n    let req = 'https://www.omdbapi.com/?apikey=2259a45a&i='+this.state.movId;\n    this.getMovieName(this, req);\n  }\n\n  inputHandler = (event) => {\n    let field = event.target.name;\n    let value = event.target.value;\n    this.setState({[field]: value});\n  }\n\n  updateDb(obj) {\n    let formObj = {\n      name: obj.state.title,\n      src: obj.state.src,\n      director: obj.state.director,\n      imdb: obj.state.imdb,\n      plot: obj.state.plot,\n    };\n    let ref = firebase.database().ref('movies');\n    ref.once('value').then(function(snapshot) {\n      let movExists = snapshot.child(obj.state.movId).exists();\n      if(movExists) {\n        alert('Already existed');\n      } \n      else {\n        ref.child(obj.state.movId).set(formObj);\n        alert('Movie has been add');\n      }\n    });\n  }\n\n  getMovieName(obj, req) {\n    axios.get(req)\n    .then(function (response) {\n      obj.setState({\n        src: response.data.Poster,\n        title: response.data.Title,\n        director: response.data.Director,\n        imdb: response.data.imdbRating,\n        plot: response.data.Plot,\n      });\n    })\n    .then(function () {\n      obj.updateDb(obj);\n    })\n    .catch(function (error) {\n      console.log(error);\n    })\n  }\n\n  render() {\n    return(\n      <div>\n        <form onSubmit={this.myFormHandler}>\n          <h1>Add a New Movie</h1>\n          <h3>Movie ID</h3>\n          <input name='movId' type='text'  required onChange={this.inputHandler}></input><br/>\n          <div className=\"color_grey\"><h5>* Please give the imdbID of the movie</h5> </div>\n          <div className=\"submit\"><input type='submit' name='submit' value='SUBMIT' style={{width: \"300px\"}}></input></div>\n          \n        </form>\n      </div>      \n    );\n  }\n}\nexport default Add_movie;\n"]},"metadata":{},"sourceType":"module"}